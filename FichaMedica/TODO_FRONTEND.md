# üîÑ TODO FRONTEND - Conectar con Backend Real

## üéØ OBJETIVO PRINCIPAL
Reemplazar **TODOS** los datos mock/placeholder del frontend con conexiones reales a los endpoints del backend que acabamos de implementar.

---

## üìã AN√ÅLISIS COMPLETO DEL FRONTEND

### üè† **Tab1Page (Dashboard)** - ‚ùå USANDO MOCKS
**Archivo**: `src/app/tab1/tab1.page.ts`

#### üîç **Datos Mock Identificados**:
```typescript
// L√çNEAS 31-36: Stats hardcodeados
stats = [
  { title: 'Pacientes Activos', value: 42, sub: '28 hospitalizados, 14 ambulatorios', icon: 'people-outline' },
  { title: 'Consultas del D√≠a', value: 18, sub: 'Cardiolog√≠a: 6, Medicina: 8, Pediatr√≠a: 4', icon: 'calendar-outline' },
  { title: 'Boxes Disponibles', value: '3/8', sub: '5 boxes ocupados', icon: 'bed-outline' },
  { title: 'Alertas Activas', value: 7, sub: '2 cr√≠ticas, 5 moderadas', icon: 'alert-circle-outline' },
];

// L√çNEAS 43-66: Pacientes y ex√°menes fake
pacientes = [
  {
    nombre: 'Juan P√©rez',
    examenes: [
      { nombre: 'Hemograma', estado: 'normal' },
      { nombre: 'Colesterol', estado: 'pendiente' }
    ]
  },
  // ... m√°s datos fake
];
```

#### ‚úÖ **Soluci√≥n - Conectar con**:
- `GET /api/dashboard/stats` ‚úÖ YA IMPLEMENTADO
- `GET /api/dashboard/alerts` ‚úÖ YA IMPLEMENTADO

---

### üë• **Tab2Page (Gesti√≥n Pacientes)** - ‚ùå USANDO MOCKS
**Archivo**: `src/app/tab2/tab2.page.ts`

#### üîç **Datos Mock Identificados**:
```typescript
// L√çNEAS 55-79: Array hardcodeado de pacientes
pacientes: Paciente[] = [
  {
    nombre: 'Ignacia Castillo',
    rut: '12.345.678-9',
    edad: 45,
    ubicacion: 'Hab. 203',
    estado: 'Estable',
    diagnostico: 'Hipertensi√≥n arterial',
    telefono: '+56 9 8765 4321',
    ultimaVisita: '2024-01-15'
  },
  // ... m√°s pacientes fake
];
```

#### ‚úÖ **Soluci√≥n - Conectar con**:
- `GET /api/patients` ‚úÖ YA IMPLEMENTADO
- `POST /api/patients` ‚úÖ YA IMPLEMENTADO
- `PUT /api/patients/:id` ‚úÖ YA IMPLEMENTADO
- `DELETE /api/patients/:id` ‚úÖ YA IMPLEMENTADO

---

### ü©∫ **Tab3Page (Ficha M√©dica)** - ‚ùå USANDO MOCKS
**Archivo**: `src/app/tab3/tab3.page.ts`

#### üîç **Datos Mock Identificados**:
```typescript
// L√çNEAS 71-156: Ficha m√©dica completa hardcodeada
ficha: FichaMedica = {
  datosPersonales: {
    nombre: 'Ignacia Castilo',
    rut: '12.345.678-9',
    edad: 45,
    tipoSanguineo: 'O+',
    direccion: 'Av. Providencia 1234, Santiago',
    contacto: '+56 9 8765 4321',
    emergencia: 'Pedro Gonz√°lez - +56 9 1111 2222'
  },
  alertasMedicas: [
    { tipo: 'alergia', descripcion: 'Penicilina', criticidad: 'alta' },
    // ... m√°s alertas fake
  ],
  examenes: [
    {
      nombre: 'Hemograma completo',
      fecha: '2024-01-20',
      resultado: 'Valores normales',
      estado: 'normal'
    },
    // ... m√°s ex√°menes fake
  ],
  evoluciones: [
    {
      fecha: '2024-01-21',
      hora: '14:30',
      medico: 'Dr. Luis Mart√≠nez',
      especialidad: 'Cardiolog√≠a',
      motivo: 'Control rutinario',
      observaciones: 'Paciente acude por control rutinario...',
      signosVitales: {
        presionArterial: '125/80 mmHg',
        frecuenciaCardiaca: 72,
        temperatura: 36.5,
        peso: 68
      }
    },
    // ... m√°s consultas fake
  ]
};
```

#### ‚úÖ **Soluci√≥n - Conectar con**:
- `GET /api/patients/:id` ‚úÖ YA IMPLEMENTADO
- `GET /api/patients/:id/consultas` ‚úÖ YA IMPLEMENTADO
- `GET /api/patients/:id/examenes` ‚úÖ YA IMPLEMENTADO

---

### üíä **Tab4Page (Medicamentos)** - ‚ùå USANDO MOCKS
**Archivo**: `src/app/tab4/tab4.page.ts`

#### üîç **Datos Mock Identificados**:
```typescript
// L√çNEAS 56-82: Medicamentos actuales hardcodeados
medicamentosActuales: Medicamento[] = [
  {
    id: 1,
    nombre: 'Metformina',
    dosis: '850 mg',
    frecuencia: '2 veces al d√≠a',
    via: 'Oral',
    indicacion: 'Control de diabetes mellitus tipo 2',
    medicoPrescriptor: 'Dr. Jos√© Fern√°ndez',
    fechaInicio: '2024-01-10',
    estado: 'Activo'
  },
  // ... m√°s medicamentos fake
];

// Tambi√©n hay arrays para:
// - interaccionesMedicamentosas
// - indicacionesMedicas
// - historialMedicamentos
```

#### ‚úÖ **Soluci√≥n - Conectar con**:
- `GET /api/patients/:id/medicamentos` ‚úÖ YA IMPLEMENTADO
- `POST /api/patients/:id/medicamentos` ‚úÖ YA IMPLEMENTADO
- `PUT /api/medicamentos/:id` ‚úÖ YA IMPLEMENTADO
- `DELETE /api/medicamentos/:id` ‚úÖ YA IMPLEMENTADO

---

### üß™ **Tab5Page (Ex√°menes)** - ‚ùå USANDO MOCKS
**Archivo**: `src/app/tab5/tab5.page.ts`

#### üîç **Datos Mock Identificados**:
```typescript
// L√çNEAS 14-33: Ex√°menes hardcodeados
examenes = [
  {
    nombre: 'Hemograma completo',
    fecha: '2024-01-20',
    resultado: 'Valores normales',
    estado: 'normal',
    detalle: 'Todos los valores dentro de rango.'
  },
  // ... m√°s ex√°menes fake
];
```

#### ‚úÖ **Soluci√≥n - Conectar con**:
- `GET /api/patients/:id/examenes` ‚úÖ YA IMPLEMENTADO
- `POST /api/patients/:id/examenes` ‚úÖ YA IMPLEMENTADO
- `PUT /api/examenes/:id` ‚úÖ YA IMPLEMENTADO

---

## üîß AN√ÅLISIS DE SERVICIOS EXISTENTES

### ‚úÖ **Servicios ya Implementados (Pero no conectados)**:

#### 1. **PatientService** (`patient.service.ts`)
- ‚úÖ **YA CONECTADO** al backend real
- ‚úÖ Endpoints implementados correctamente
- ‚úÖ Manejo de errores robusto
- ‚úÖ Estado reactivo con BehaviorSubjects

#### 2. **MedicalConsultationService** (`medical-consultation.service.ts`)
- ‚ùå **NO CONECTADO** - Usa endpoints incorrectos
- ‚ùå Apunta a `/consultations` en lugar de `/patients/:id/consultas`

#### 3. **MedicationService** (`medication.service.ts`)
- ‚ùå **NO CONECTADO** - Usa endpoints incorrectos
- ‚ùå Apunta a `/medications` en lugar de `/patients/:id/medicamentos`

### ‚ùå **Servicios Faltantes**:
- **DashboardService** - Para estad√≠sticas
- **ExamService** - Para gesti√≥n de ex√°menes
- **AlertService** - Para alertas del sistema

---

## üìÖ PLAN DE IMPLEMENTACI√ìN

### üöÄ **FASE 1: Crear Servicios Faltantes**
**Prioridad**: CR√çTICA ‚ö†Ô∏è

#### 1.1 **DashboardService**
```typescript
// Crear: src/app/services/dashboard.service.ts
class DashboardService {
  getDashboardStats(): Observable<DashboardStats>
  getDashboardAlerts(): Observable<Alert[]>
}
```

#### 1.2 **ExamService**
```typescript
// Crear: src/app/services/exam.service.ts
class ExamService {
  getPatientExams(patientId: string): Observable<ExamListResponse>
  createExam(patientId: string, exam: CreateExamRequest): Observable<Exam>
  updateExam(examId: string, updates: UpdateExamRequest): Observable<Exam>
  deleteExam(examId: string): Observable<void>
}
```

#### 1.3 **AlertService**
```typescript
// Crear: src/app/services/alert.service.ts
class AlertService {
  getActiveAlerts(): Observable<Alert[]>
  markAlertAsRead(alertId: string): Observable<void>
}
```

### üöÄ **FASE 2: Corregir Servicios Existentes**
**Prioridad**: ALTA üî¥

#### 2.1 **Actualizar MedicalConsultationService**
- Cambiar endpoints de `/consultations` a `/patients/:id/consultas`
- Actualizar m√©todos para usar patientId

#### 2.2 **Actualizar MedicationService** 
- Cambiar endpoints de `/medications` a `/patients/:id/medicamentos`
- Actualizar m√©todos para usar patientId

### üöÄ **FASE 3: Conectar Tab1Page (Dashboard)**
**Prioridad**: ALTA üî¥

#### 3.1 **Reemplazar datos mock**:
```typescript
// ANTES (mock):
stats = [/* datos hardcodeados */];

// DESPU√âS (real):
constructor(private dashboardService: DashboardService) {}
ngOnInit() {
  this.dashboardService.getDashboardStats().subscribe(stats => {
    this.stats = this.transformStats(stats);
  });
}
```

#### 3.2 **Conectar alertas de ex√°menes**:
```typescript
// ANTES (mock):
pacientes = [/* datos fake */];

// DESPU√âS (real):
this.alertService.getActiveAlerts().subscribe(alerts => {
  this.alertas = alerts;
});
```

### üöÄ **FASE 4: Conectar Tab2Page (Pacientes)**
**Prioridad**: ALTA üî¥

#### 4.1 **Conectar con PatientService**:
```typescript
// ANTES (mock):
pacientes: Paciente[] = [/* datos fake */];

// DESPU√âS (real):
constructor(private patientService: PatientService) {}
ngOnInit() {
  this.loadPatients();
}

loadPatients() {
  this.patientService.getPatients().subscribe(response => {
    this.pacientes = response.patients;
  });
}
```

#### 4.2 **Conectar CRUD operations**:
- ‚úÖ CREATE: Usar `patientService.createPatient()`
- ‚úÖ UPDATE: Usar `patientService.updatePatient()`
- ‚úÖ DELETE: Usar `patientService.deletePatient()`
- ‚úÖ SEARCH: Usar `patientService.getPatients(page, limit, search)`

### üöÄ **FASE 5: Conectar Tab3Page (Ficha M√©dica)**
**Prioridad**: ALTA üî¥

#### 5.1 **Cargar datos del paciente**:
```typescript
// ANTES (mock):
ficha: FichaMedica = {/* datos fake */};

// DESPU√âS (real):
constructor(
  private patientService: PatientService,
  private consultationService: MedicalConsultationService,
  private examService: ExamService
) {}

ngOnInit() {
  const patientId = this.getPatientIdFromRoute();
  this.loadPatientData(patientId);
}

loadPatientData(patientId: string) {
  forkJoin({
    patient: this.patientService.getPatientById(patientId),
    consultations: this.consultationService.getPatientConsultations(patientId),
    exams: this.examService.getPatientExams(patientId)
  }).subscribe(data => {
    this.ficha = this.buildFichaMedica(data);
  });
}
```

### üöÄ **FASE 6: Conectar Tab4Page (Medicamentos)**
**Prioridad**: MEDIA üü°

#### 6.1 **Cargar medicamentos del paciente**:
```typescript
// ANTES (mock):
medicamentosActuales: Medicamento[] = [/* datos fake */];

// DESPU√âS (real):
constructor(private medicationService: MedicationService) {}

ngOnInit() {
  const patientId = this.getPatientIdFromRoute();
  this.loadMedications(patientId);
}

loadMedications(patientId: string) {
  this.medicationService.getPatientMedications(patientId).subscribe(response => {
    this.medicamentosActuales = response.medications;
  });
}
```

### üöÄ **FASE 7: Conectar Tab5Page (Ex√°menes)**
**Prioridad**: MEDIA üü°

#### 7.1 **Cargar ex√°menes del paciente**:
```typescript
// ANTES (mock):
examenes = [/* datos fake */];

// DESPU√âS (real):
constructor(private examService: ExamService) {}

ngOnInit() {
  const patientId = this.getPatientIdFromRoute();
  this.loadExams(patientId);
}

loadExams(patientId: string) {
  this.examService.getPatientExams(patientId).subscribe(response => {
    this.examenes = response.exams;
  });
}
```

### üöÄ **FASE 8: Implementar Navegaci√≥n Din√°mica**
**Prioridad**: BAJA üü¢

#### 8.1 **Pasar IDs de pacientes entre rutas**:
```typescript
// En Tab2Page (lista pacientes):
verFicha(paciente: Paciente) {
  this.router.navigate(['/tabs/tab3'], { 
    queryParams: { patientId: paciente.id } 
  });
}

// En Tab3Page (ficha m√©dica):
ngOnInit() {
  this.route.queryParams.subscribe(params => {
    if (params['patientId']) {
      this.loadPatientData(params['patientId']);
    }
  });
}
```

---

## üîç ARCHIVOS A MODIFICAR

### üìÅ **Servicios Nuevos a Crear**:
1. `src/app/services/dashboard.service.ts` ‚ùå
2. `src/app/services/exam.service.ts` ‚ùå 
3. `src/app/services/alert.service.ts` ‚ùå

### üìÅ **Servicios a Modificar**:
1. `src/app/services/medical-consultation.service.ts` ‚úèÔ∏è
2. `src/app/services/medication.service.ts` ‚úèÔ∏è

### üìÅ **P√°ginas a Conectar**:
1. `src/app/tab1/tab1.page.ts` ‚úèÔ∏è **Dashboard**
2. `src/app/tab2/tab2.page.ts` ‚úèÔ∏è **Pacientes**
3. `src/app/tab3/tab3.page.ts` ‚úèÔ∏è **Ficha M√©dica**
4. `src/app/tab4/tab4.page.ts` ‚úèÔ∏è **Medicamentos**
5. `src/app/tab5/tab5.page.ts` ‚úèÔ∏è **Ex√°menes**

### üìÅ **Routing a Actualizar**:
1. `src/app/app.routes.ts` ‚úèÔ∏è **Par√°metros de ruta**
2. `src/app/tabs/tabs.routes.ts` ‚úèÔ∏è **Par√°metros de ruta**

---

## ‚úÖ CRITERIOS DE √âXITO

### üéØ **Funcionalidad**:
- [ ] ‚ùå Dashboard muestra datos reales del backend
- [ ] ‚ùå Lista de pacientes carga desde API
- [ ] ‚ùå CRUD de pacientes funciona completamente
- [ ] ‚ùå Ficha m√©dica carga datos reales del paciente
- [ ] ‚ùå Medicamentos y ex√°menes cargan desde API
- [ ] ‚ùå Navegaci√≥n entre p√°ginas con IDs reales

### üéØ **Performance**:
- [ ] ‚ùå Carga inicial < 2 segundos
- [ ] ‚ùå B√∫squeda de pacientes < 1 segundo
- [ ] ‚ùå Navegaci√≥n entre fichas instant√°nea

### üéØ **UX**:
- [ ] ‚ùå Loading states implementados
- [ ] ‚ùå Error handling con mensajes user-friendly
- [ ] ‚ùå Estados vac√≠os manejados correctamente

---

## üö® NOTAS IMPORTANTES

### ‚ö†Ô∏è **Backend Ready**:
- ‚úÖ **Todos los endpoints funcionando** en `localhost:3000`
- ‚úÖ **Base de datos con datos reales** 
- ‚úÖ **CORS configurado** correctamente
- ‚úÖ **Validaciones robustas** implementadas

### ‚ö†Ô∏è **Frontend Tasks**:
1. **NO modificar** la UI/UX existente
2. **Solo reemplazar** datos mock con llamadas API reales
3. **Mantener** la funcionalidad actual
4. **Agregar** manejo de estados de loading/error
5. **Implementar** navegaci√≥n con IDs reales

### ‚ö†Ô∏è **Testing Strategy**:
1. Probar cada p√°gina individualmente
2. Verificar que no hay errores en consola
3. Confirmar que datos se cargan correctamente
4. Validar que CRUD operations funcionan
5. Test navegaci√≥n entre p√°ginas

---

## üìä PROGRESO TRACKING

### ‚úÖ **Completado**:
- [x] Backend completamente implementado
- [x] PatientService ya conectado al backend
- [x] Endpoints de API funcionando

### üöß **En Progreso**:
- [ ] An√°lisis completo del frontend (ESTE DOCUMENTO)

### ‚è≥ **Pendiente**:
- [ ] Creaci√≥n de servicios faltantes
- [ ] Correcci√≥n de servicios existentes  
- [ ] Conexi√≥n de todas las p√°ginas
- [ ] Testing completo

---

**Estado Actual**: üìã **AN√ÅLISIS COMPLETO** - LISTO PARA IMPLEMENTACI√ìN

**Pr√≥ximo Paso**: üöÄ **FASE 1** - Crear servicios faltantes (DashboardService, ExamService, AlertService)