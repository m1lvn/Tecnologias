<!-- Topbar -->
<ion-header>
  <ion-toolbar>
    <ion-title>Ficha Clínica Unificada</ion-title>
    <ion-buttons slot="end" class="actions">
      <ion-button fill="outline" color="light" class="action-btn">
        <ion-icon slot="start" name="share-outline"></ion-icon>
        Compartir
      </ion-button>
      <ion-button fill="solid" color="light" class="action-btn">
        <ion-icon slot="start" name="cloud-download-outline"></ion-icon>
        Exportar FHIR Bundle
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding page-bg">

  <!-- Barra de búsqueda -->
  <div class="search-row">
    <ion-icon name="search-outline"></ion-icon>
    <input placeholder="RUT o nombre" />
  </div>

  <!-- Tabs/secciones (barra superior del mockup) -->
  <div class="section-tabs">
    <button class="tab active">Resumen</button>
    <button class="tab">Evolución</button>
    <button class="tab">Medicamentos</button>
    <button class="tab">Alergias</button>
    <button class="tab">Laboratorio</button>
    <button class="tab">Imagenología</button>
    <button class="tab">Auditoría</button>
  </div>

  <!-- Info de paciente compacta -->
  <div class="patient-bar">
    <div class="avatar">JM</div>
    <div class="data">
      <div class="name">Julina Martinez</div>
      <div class="meta">12.345.679-9 • 45 años • F • FONASA</div>
    </div>
  </div>

  <ion-grid fixed>

    <ion-row class="top-cards">

      <!-- Columna izquierda -->
      <ion-col size="12" sizeMd="3">
        <ion-card class="pane">
          <ion-cardHeader><ion-card-title>Estado de la red</ion-card-title></ion-cardHeader>
          <ion-card-content>
            <div class="net-item"><span class="dot ok"></span> Hospital Central <small>Ev. 22 h</small></div>
            <div class="net-item"><span class="dot warn"></span> Clínica Norte</div>
            <div class="net-item"><span class="dot err"></span> Hospital del Sur</div>
          </ion-card-content>
        </ion-card>

        <ion-card class="pane">
          <ion-cardHeader><ion-card-title>Filtros</ion-card-title></ion-cardHeader>
          <ion-card-content>
            <div class="filter-row">
              <div class="label">Fecha</div>
              <div class="value">01/04/2024 → 02/04/2024</div>
            </div>
            <div class="filter-row">
              <div class="label">Tipo de dato</div>
              <div><span class="chip">Todos los tipos</span></div>
            </div>
            <div class="filter-row">
              <div class="label">Consentimiento</div>
              <div class="value link">Configurar permisos</div>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <!-- Columna central -->
      <ion-col size="12" sizeMd="6">
        <ion-card class="pane">
          <ion-cardHeader><ion-card-title>Signos vitales</ion-card-title></ion-cardHeader>
          <ion-card-content>
            <canvas #vitales></canvas>
          </ion-card-content>
        </ion-card>

        <ion-card class="pane">
          <ion-cardHeader><ion-card-title>Encuentros</ion-card-title></ion-cardHeader>
          <ion-card-content>
            <div class="encuentro" *ngFor="let e of encuentros">
              <div class="enc-icon" [class.med]="e.icon==='med'" [class.urg]="e.icon==='urg'" [class.card]="e.icon==='card'"></div>
              <div class="enc-body">
                <div class="enc-title">{{e.titulo}}</div>
                <div class="enc-sub">• {{e.lugar}}  •  {{e.fecha}}</div>
              </div>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <!-- Columna derecha -->
      <ion-col size="12" sizeMd="3">
        <ion-card class="pane">
          <ion-cardHeader><ion-card-title>Resumen</ion-card-title></ion-cardHeader>
          <ion-card-content>
            <div class="resumen-item" *ngFor="let r of resumen">
              <div class="bar" [style.background]="r.color"></div>
              <div class="r-body">
                <div class="r-title">{{r.titulo}}</div>
                <div class="r-sub">{{r.sub}}</div>
              </div>
              <ion-badge color="light" class="go">›</ion-badge>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>

    </ion-row>

  </ion-grid>
</ion-content>
